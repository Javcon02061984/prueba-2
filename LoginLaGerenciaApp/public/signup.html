<!DODTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,  initial-scale=1.0">
    <title>RegistrolaGenerica</title>
    <link rel="stylessheet" href="main.css"
</head>
<body>
    <div class=container>
        <form action="/register" method="POST">
        <H2>REGISTRO</H2>
        <div class="section">
            <div class="title">usuario</div>
            <div class="field"><input type="text" id="usuario" name="user"></div>
        </div>
        <div class="section">
            <div class="title">contraseña</div>
            <div class="field"><input type="password" id="contrasena" name="password"></div>
        </div>
        <div>
            <div class="button"><input type="submit" value="Registrar usuario"></div>
            <div class="button"><a href="index.html">Login</a></div>
        </div>
        </form>    
    </div>
</body>

</html>

##Este código se pega en el  usuario modelo##
Se debe llamar 
const mongoose = require('mongoose');
const bcrypt = require('bcrypt');

Una constante de encriptación

const saltRounds = 10;

Y el siguiente método

const UserSchema = new mongoose.Schema({
    username: { type: String, required: true, unique: true},
    password: { type: String, required: true}
});

Con esta función 

UserSchema.pre('save', function(next) {
    if(this.isNew || this.isModified('password')){

        const document = this;

        bcrypt.hash(document.password, saltRounds, (err, hashedPassword) => {
            if(err){
                next(err);
            }else{
                document.password = hashedPassword;
                next();
            }
        });
    
    }else{
        next();
    }
});

UserSchema.methods.isCorrectPassword = function(password, callback){
    bcrypt.compare(password, this.password, function(err, same));
        if(err){
            callback(err);
        }else{
            callback(err, same);
        }
    });

}
module.exports = mongoose.model('User', UserSchema);
